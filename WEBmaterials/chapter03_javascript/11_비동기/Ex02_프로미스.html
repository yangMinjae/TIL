<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>
<body>
  
</body>
<script>
  /*
    프로미스(Promise)
    
    자바스크립트의 비동기 작업을 처리하고, 결과를 다루는 객체
    이전 콜백 함수로 모든 비동기를 처리해야하는 상황을 편리하게 사용하기 위해
    ES6 부터 도입

    상태
    1. 대기(Pending) - 비동기 작업이 완료되지 않음
    2. 이행(Fulfilled) - 비동기 작업이 성공적으로 완료
    3. 거부(Rejected) - 비동기 작업이 실패

    프로미스 생성
    - new 키워드를 이용하여 Promise 생성자 호출
    호출하면 두 개의 콜백 함수를 파라미터로 받는다.
    첫 번째 resolve - 작업이 성공하면 호출
    두번째 reject - 작업이 실패하면 호출
    const prom = new Promise((resolve, reject)=>{
      // 코드
    });
  */

  // 프로미스 객체가 담긴 prom을 호출할 때
  // 성공하면 then() 함수를,
  // 실패했을 때 catch() 함수를 붙여서 사용.
  const prom1 = new Promise((resolve, reject)=>{
    resolve('성공ddd');
  });

  prom1.then(result =>{       // result는 '성공'
    console.log(result);
  });

  const prom2 = new Promise((resolve, reject)=>{
    reject('실패ddd');
  });
  prom2.catch(err=>{
    console.log(err);
  })

  const prom = new Promise((resolve, reject)=>{
    // 1~10 사이의 정수형 랜덤값을 구해서
    // 5보다 큰값일때는 resolve를,
    // 그렇지 못한 때에는 reject를 실행
    let ran = Math.floor(Math.random()*10)+1;
    console.log(ran);
    ran > 5 ? resolve('성공') : reject(new Error('실패'));
  })

  prom.then(result => {console.log(result);
  }).catch(err=>{console.log(err);
  });

  const print = function(n){
    return new Promise((resolve, reject)=>{
      setTimeout(() => {
        let val = n+1;
        console.log(val);
        if(val<5){
          resolve(val);
        }
      }, 1000);
    })
  }
  print(2)
  .then(n=>{return print(n)})
  .then(n=>{return print(n)})
  .then(n=>{return print(n)})
  .then(n=>{return print(n)});
</script>
</html>